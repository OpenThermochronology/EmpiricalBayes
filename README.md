This Jupyter notebook demonstrates the use of a form of empirical Bayes (also known as hierarchical Bayes) resampling for more robust (U-Th)/He data uncertainty estimation for use in thermal-history inversions. See Malinverno and Briggs (2004) for descriptions of the general Bayesian method. As described and implemented here, it is particularly suited for zircon datasets (high n) that span a broad range of effective uranium (eU). The aim is to expand uncertainty accounting where the hyperparameters (i.e., observed He dates) will have a prior distribution that expresses their initial uncertainty and a posterior distribution that is determined by the data directly. The individual date errors are treated as hyperparameters drawn from a probability distribution and the variance is used to infer the 'empirical' date uncertainty. This weighted 1σ uncertainty is inferred from the scatter of the data as determined by the standard deviation of the data weighted by a Gaussian kernel in eU space (σeU = 100 ppm). The 100 ppm eU kernel is taken to represent the range over which zircon grains with similar eU should have similar ages. This value was chosen as a good balance because smaller values tend to converge on the internal uncertainty and larger values begin to reduce the influence of individual dates during thermal modelling. The empirical uncertainty is estimated by summing the internal and external uncertainties in quadrature. Importantly, the Bayes approach retains the observed date calculated from the measured isotopic data but the uncertainties are estimated from the data directly. Error resampling is helpful during modelling when errors are underestimated and prevents the t–T search algorithm from becoming trapped in local minima (in the case of learning algorithms such as Markov chain Monte Carlo) by reducing overprecision.

[![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/kmcdannell/helium-empirical-bayes.git/main?filepath=%2FEmpirical-Bayes-Resampling.ipynb)
